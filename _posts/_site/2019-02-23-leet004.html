<blockquote>
  <p>给定两个大小为 m 和 n 的有序数组 nums1 和 nums2。</p>

  <p>请你找出这两个有序数组的中位数，并且要求算法的时间复杂度为 O(log(m + n))。</p>

  <p>你可以假设 nums1 和 nums2 不会同时为空。</p>

  <p>示例 1:</p>
  <blockquote>
    <p>nums1 = [1, 3]</p>

    <p>nums2 = [2]</p>

    <p>则中位数是 2.0</p>
  </blockquote>
</blockquote>

<h1 id="1-pythonic的解法其实这个方法时间复杂度没有达到要求">1. pythonic的解法&amp;~(其实这个方法时间复杂度没有达到要求)</h1>
<p>一个可读性高,时间复杂度也不算太过分的写法</p>

<p>我写完发现效果很惊喜, 然后才注意到是python的sort很强大.python的sort是用的一个叫<a href="https://www.infopulse.com/blog/timsort-sorting-algorithm/">timsort</a>的算法,时间是O(nlog(n)),timsort大致是三步:</p>
<ol>
  <li><strong>把数据分成多个段(run)</strong>: 扫描数组,找到有序(单调增或减,把单调减的段反转)的段,把它当作一个run</li>
  <li><strong>整理run</strong>: 定义最小run长度,不够长的run用插入排序合并直至够长</li>
  <li><strong>用归并排序合并所有的run</strong></li>
</ol>

<p>也就是说,在这个实例里,实际上并没有进行完全的重新排序</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">findMedianSortedArrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums1</span><span class="p">:</span> <span class="s">'List[int]'</span><span class="p">,</span> <span class="n">nums2</span><span class="p">:</span> <span class="s">'List[int]'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s">'float'</span><span class="p">:</span>
        <span class="n">nums</span> <span class="o">=</span> <span class="n">nums1</span><span class="o">+</span><span class="n">nums2</span>
        <span class="n">nums</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">return</span> <span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">nums</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">nums</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div></div>
<blockquote>
  <p>100ms 6.8MB 99.56% 91.99%</p>
</blockquote>

<h1 id="2-归并">2. 归并</h1>
<p>方法一是用的自带的sort(),自己写有序数列合并试试.</p>

<ul>
  <li>学习了下<a href="http://python.jobbole.com/82549/">list的实现</a>,为了减少list的多次resize,我用了三个指针来避免删除或append元素</li>
  <li>连续赋值是python一个有趣的地方,实验了下发现</li>
  <li>比如a=b=1,操作起来是先a=1,再b=1</li>
  <li>而a,b = 3,a的话,是先a=3,再b=<em>a</em>,而最后这个斜体的a比较有趣,它不一定是3,却是在执行这个语句前a的值</li>
</ul>

<p>先顺路写个归并排序(升序),分治递归</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">merge_sort</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">list</span>
  <span class="n">left</span> <span class="o">=</span> <span class="n">merge_sort</span><span class="p">(</span><span class="nb">list</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
  <span class="n">right</span> <span class="o">=</span> <span class="n">merge_sort</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="o">/</span><span class="mi">2</span><span class="p">):])</span>  
  <span class="k">return</span> <span class="n">merge_lists</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="n">right</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">merge_lists</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="n">list2</span><span class="p">):</span>
  <span class="n">p1</span> <span class="o">=</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">result_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">list2</span><span class="p">))</span>
  <span class="k">while</span> <span class="n">p1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p2</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">list2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">list1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">list2</span><span class="p">[</span><span class="n">p2</span><span class="p">]:</span>
      <span class="n">result_list</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">list1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span>
      <span class="n">q</span><span class="p">,</span><span class="n">p1</span> <span class="o">=</span> <span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">p1</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">elif</span> <span class="n">list1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">list2</span><span class="p">[</span><span class="n">p2</span><span class="p">]:</span>
      <span class="n">result_list</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">list2</span><span class="p">[</span><span class="n">p2</span><span class="p">]</span>
      <span class="n">q</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">p2</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">elif</span> <span class="n">list1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span> <span class="o">==</span> <span class="n">list2</span><span class="p">[</span><span class="n">p2</span><span class="p">]:</span>
      <span class="n">result_list</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">list1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span>
      <span class="n">result_list</span><span class="p">[</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">list1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span>
      <span class="n">q</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">q</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">p1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">p2</span><span class="o">+</span><span class="mi">1</span>

  <span class="k">if</span> <span class="n">p1</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p2</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">list2</span><span class="p">):</span>
    <span class="n">result_list</span><span class="p">[</span><span class="n">q</span><span class="p">:]</span> <span class="o">=</span> <span class="n">list2</span><span class="p">[</span><span class="n">p2</span><span class="p">:]</span>
  <span class="k">elif</span> <span class="n">p1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p2</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">list2</span><span class="p">):</span>
    <span class="n">result_list</span><span class="p">[</span><span class="n">q</span><span class="p">:]</span> <span class="o">=</span> <span class="n">list1</span><span class="p">[</span><span class="n">p1</span><span class="p">:]</span>

  <span class="k">return</span> <span class="n">result_list</span>
</code></pre></div></div>

<p>然后稍微改下:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">findMedianSortedArrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums1</span><span class="p">:</span> <span class="s">'List[int]'</span><span class="p">,</span> <span class="n">nums2</span><span class="p">:</span> <span class="s">'List[int]'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s">'float'</span><span class="p">:</span>
      <span class="n">p1</span> <span class="o">=</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nums1</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">nums2</span><span class="p">))</span>
      <span class="k">while</span> <span class="n">p1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">nums1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p2</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">nums2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">nums1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">nums2</span><span class="p">[</span><span class="n">p2</span><span class="p">]:</span>
          <span class="n">nums</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span>
          <span class="n">q</span><span class="p">,</span><span class="n">p1</span> <span class="o">=</span> <span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">p1</span><span class="o">+</span><span class="mi">1</span>

        <span class="k">elif</span> <span class="n">nums1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">nums2</span><span class="p">[</span><span class="n">p2</span><span class="p">]:</span>
          <span class="n">nums</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums2</span><span class="p">[</span><span class="n">p2</span><span class="p">]</span>
          <span class="n">q</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">p2</span><span class="o">+</span><span class="mi">1</span>

        <span class="k">elif</span> <span class="n">nums1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span> <span class="o">==</span> <span class="n">nums2</span><span class="p">[</span><span class="n">p2</span><span class="p">]:</span>
          <span class="n">nums</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span>
          <span class="n">nums</span><span class="p">[</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums1</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span>
          <span class="n">q</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">q</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">p1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">p2</span><span class="o">+</span><span class="mi">1</span>

      <span class="k">if</span> <span class="n">p1</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">nums1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p2</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">nums2</span><span class="p">):</span>
        <span class="n">nums</span><span class="p">[</span><span class="n">q</span><span class="p">:]</span> <span class="o">=</span> <span class="n">nums2</span><span class="p">[</span><span class="n">p2</span><span class="p">:]</span>
      <span class="k">elif</span> <span class="n">p1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">nums1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p2</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums2</span><span class="p">):</span>
        <span class="n">nums</span><span class="p">[</span><span class="n">q</span><span class="p">:]</span> <span class="o">=</span> <span class="n">nums1</span><span class="p">[</span><span class="n">p1</span><span class="p">:]</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">nums</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">nums</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div></div>
<blockquote>
  <table>
    <tbody>
      <tr>
        <td>124ms 6.9MB</td>
        <td>69.98% 88.23%</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<h1 id="3-王者二叉树">3. 王者二叉树</h1>

<p>看下答案的写法,(严格来讲,只有这个算法能通过题目)</p>

<p>好复杂,但它能把时间控制在O(log(min(m,n))</p>

<p><strong>算法目标</strong> 就是把两个list分成这样</p>

<table border="1">
  <tr>
    <th></th>
    <th>合并列表的左边</th>
    <th>合并列表的右边</th>
  </tr>
  <tr>
    <td>list1分成左右两部分</td>
    <td>list1[:i]</td>
    <td>list1[i:]</td>
  </tr>
  <tr>
    <td>list2分成左右两部分</td>
    <td>list2[:j]</td>
    <td>list2[j:]</td>
  </tr>
</table>

<p>并且根据中位数定义满足两个条件</p>
<ul>
  <li>len(left_part)=len(right_part)</li>
  <li>max(合并列表的左边)&lt;=min(合并列表的右边)</li>
</ul>

<p><strong>具体算法实现</strong> 是通过二叉树搜索,把i作为唯一变量,在[0,len(nums1+nums2)]范围内寻找满足约束条件的i</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">findMedianSortedArrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums1</span><span class="p">:</span> <span class="s">'List[int]'</span><span class="p">,</span> <span class="n">nums2</span><span class="p">:</span> <span class="s">'List[int]'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s">'float'</span><span class="p">:</span>
      <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums2</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
          <span class="n">nums1</span><span class="p">,</span> <span class="n">nums2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">nums2</span><span class="p">,</span> <span class="n">nums1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span>
      <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">raise</span> <span class="nb">ValueError</span>

      <span class="n">imin</span><span class="p">,</span> <span class="n">imax</span><span class="p">,</span> <span class="n">half_len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
      <span class="k">while</span> <span class="n">imin</span> <span class="o">&lt;=</span> <span class="n">imax</span><span class="p">:</span>
          <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">imin</span> <span class="o">+</span> <span class="n">imax</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
          <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">half_len</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="ow">and</span> <span class="n">nums2</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">nums1</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
              <span class="c"># i is too small, must increase it</span>
              <span class="n">imin</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
          <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nums1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">nums2</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
              <span class="c"># i is too big, must decrease it</span>
              <span class="n">imax</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="c"># i is perfect</span>

              <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">max_of_left</span> <span class="o">=</span> <span class="n">nums2</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
              <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">max_of_left</span> <span class="o">=</span> <span class="n">nums1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
              <span class="k">else</span><span class="p">:</span> <span class="n">max_of_left</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nums1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nums2</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

              <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                  <span class="k">return</span> <span class="n">max_of_left</span>

              <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">m</span><span class="p">:</span> <span class="n">min_of_right</span> <span class="o">=</span> <span class="n">nums2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
              <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span> <span class="n">min_of_right</span> <span class="o">=</span> <span class="n">nums1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
              <span class="k">else</span><span class="p">:</span> <span class="n">min_of_right</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">nums1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nums2</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

              <span class="k">return</span> <span class="p">(</span><span class="n">max_of_left</span> <span class="o">+</span> <span class="n">min_of_right</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
</code></pre></div></div>
