I"PÊ<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      processEscapes: true
    }
  });
  </script>

<script type="text/javascript" async="" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<blockquote>
  <p>æœ¬æ–‡å†…å®¹å¤§è‡´ç¿»è¯‘è‡ª<a href="https://victorzhou.com/blog/intro-to-neural-networks/">Machine Learning for Beginners: An Introduction to Neural Networks</a>ï¼Œæˆ‘ä¸ªäººä¿®æ”¹æˆ–æ·»åŠ äº†éƒ¨åˆ†å†…å®¹ï¼Œè‹¥æ„Ÿè§‰ä»·å€¼ä¸é«˜ï¼Œè¯·è·³è¿‡æˆ–å‚é˜…åŸæ–‡ã€‚</p>
</blockquote>

<div style="display: none">
&gt; æœ¬æ–‡ä»£ç å¯è§[Github](TODO)ã€‚
</div>

<h1 id="é¢å‘åˆå­¦è€…çš„æœºå™¨å­¦ä¹ æ•™ç¨‹ç¥ç»ç½‘ç»œç®€ä»‹">é¢å‘åˆå­¦è€…çš„æœºå™¨å­¦ä¹ æ•™ç¨‹ï¼šç¥ç»ç½‘ç»œç®€ä»‹</h1>
<p><strong>ç®€å•è§£é‡Šç¥ç»ç½‘ç»œå¦‚ä½•å·¥ä½œï¼Œå¹¶ä¸”ä»é›¶å¼€å§‹ä½¿ç”¨Pythonå®ç°ä¸€ä¸ªç¥ç»ç½‘ç»œã€‚</strong></p>

<p>ç¥ç»ç½‘ç»œå¯èƒ½å¹¶æ²¡æœ‰ä½ æƒ³è±¡çš„é‚£ä¹ˆå¤æ‚ã€‚è™½ç„¶â€œç¥ç»ç½‘ç»œâ€è¿™ä¸ªè¯ç»å¸¸è¢«ç”¨ä½œæµè¡Œè¯­ï¼Œä½†å®é™…ä¸Šå®ƒæ¯”äººä»¬å¾€å¾€æƒ³è±¡çš„è¦ç®€å•å¾—å¤šã€‚</p>

<p>è¿™ç¯‡æ–‡ç« æ˜¯ä¸ºå®Œå…¨åˆå­¦è€…å‡†å¤‡çš„ï¼Œå³ä½¿é›¶åŸºç¡€çš„å°ç™½ä¹Ÿæ˜¯é€‚ç”¨çš„ã€‚æˆ‘ä»¬å°†äº†è§£ç¥ç»ç½‘ç»œå¦‚ä½•å·¥ä½œï¼Œå¹¶ä¸”ä»é›¶å¼€å§‹ä½¿ç”¨Pythonå®ç°ä¸€ä¸ªç¥ç»ç½‘ç»œã€‚</p>

<p>ä¸€ä¸ªå¾ˆå¥½ç©çš„æ˜¯ï¼šæˆ‘é’ˆå¯¹è¿™ç¯‡æ–‡ç« åˆ¶ä½œäº†ä¸€ä¸ªåŸºäºJupyter Notebookçš„åŠ¨æ€æ•™ç¨‹ï¼Œ<a href="http://file.loopy.tech/release/IntroToNN.html">è¿™é‡Œ</a>å°±æ˜¯playgroundç¤ºä¾‹ã€‚</p>

<p>ç°åœ¨å¼€å§‹æˆ‘ä»¬çš„æ•™ç¨‹ï¼</p>

<h2 id="1-åˆ¶ä½œä¸€ä¸ªç¥ç»å…ƒ">1. åˆ¶ä½œä¸€ä¸ªç¥ç»å…ƒ</h2>

<h3 id="11-ä»€ä¹ˆæ˜¯ç¥ç»å…ƒ">1.1 ä»€ä¹ˆæ˜¯ç¥ç»å…ƒï¼Ÿ</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦çŸ¥é“ä»€ä¹ˆæ˜¯ç¥ç»å…ƒã€‚å®ƒæ˜¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•ä½ï¼Œç”¨æ¥æ¥å—è¾“å…¥ï¼Œåšä¸€äº›æ•°å­¦è¿ç®—ï¼Œç„¶åäº§ç”Ÿä¸€ä¸ªè¾“å‡ºã€‚è¿™æ˜¯ä¸€ä¸ª2è¾“å…¥ç¥ç»å…ƒçš„ç¤ºæ„å›¾:
<img src="https://github.com/loopyme/loopyme.github.io/blob/master/_posts/pic/2019-05-01/1.png?raw=true" alt="neurons.png" /></p>

<p>ä½ å®Œå…¨å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªç¥ç»å…ƒï¼ˆå‡½æ•°ï¼‰é‡Œå‘ç”Ÿäº†ä¸‰ä¸ªè¿ç®—ï¼š</p>
<ol>
  <li>
    <p>æ¯ä¸ªè¾“å…¥åˆ†åˆ«ä¹˜ä»¥ä¸€ä¸ª<strong>æƒé‡w1,w2</strong>ï¼ˆweightï¼‰</p>

    <script type="math/tex; mode=display">x_1 â†’ x_1 * w_1</script>

    <script type="math/tex; mode=display">x_2 â†’ x_2 * w_2</script>
  </li>
  <li>
    <p>å°†ä¸Šä¸€æ­¥çš„ç»“æœåŠ èµ·æ¥ï¼Œå†åŠ ä¸Šä¸€ä¸ª<strong>åç½®b</strong>ï¼ˆbiasï¼‰</p>

    <script type="math/tex; mode=display">(x_1 Ã— w_1)+(x_2 Ã— w_2)+ b</script>
  </li>
  <li>
    <p>æŠŠä¸Šä¸€æ­¥çš„ç»“æœå¸¦å…¥<strong>æ¿€æ´»å‡½æ•°</strong>ï¼ˆactivation functionï¼‰ä¸­è¿›è¡Œè®¡ç®—ã€‚äºæ˜¯å°±å¯ä»¥æŠŠè¾“å‡ºè¡¨ç¤ºä¸ºï¼š</p>

    <script type="math/tex; mode=display">y= f(x_1 âˆ— w_1 + x_2 âˆ— w_2 + b)</script>
  </li>
</ol>

<p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½æœ‰ä¸¤ä¸ªç–‘é—®ï¼š</p>
<ol>
  <li>
    <p>æ¿€æ´»å‡½æ•°f(x)æ˜¯ä»€ä¹ˆï¼Ÿ</p>

    <p>æ¿€æ´»å‡½æ•°çš„ä½œç”¨æ˜¯å°†æ— é™åˆ¶çš„è¾“å…¥è½¬æ¢ä¸ºå¯é¢„æµ‹å½¢å¼çš„è¾“å‡ºã€‚å®ƒæ˜¯ä¸€ç±»å‡½æ•°çš„æ€»ç§°ï¼Œå…¶ä¸­ä¸€ç§å¾ˆå¸¸ç”¨çš„æ¿€æ´»å‡½æ•°æ˜¯sigmoidå‡½æ•°ï¼Œå®ƒèƒ½å°†å˜é‡æ˜ å°„åˆ°0,1ä¹‹é—´ï¼Œè¡¨è¾¾å¼ä¸º
 <script type="math/tex">f(x) = \frac{1}{1+e^{-x}}</script>
 åœ¨åæ ‡è½´ä¸Šè¡¨ç°æ˜¯è¿™æ ·çš„ <img src="https://github.com/loopyme/loopyme.github.io/blob/master/_posts/pic/2019-05-01/2.png?raw=true" alt="sigmoid.png" /></p>

    <p>sigmoidå‡½æ•°çš„è¾“å‡ºä»‹äº0å’Œ1ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºå®ƒæŠŠ (âˆ’âˆ,+âˆ) èŒƒå›´å†…çš„æ•°å‹ç¼©åˆ° (0, 1)ä»¥å†…ã€‚æ­£å€¼è¶Šå¤§è¾“å‡ºè¶Šæ¥è¿‘1ï¼Œè´Ÿå‘æ•°å€¼è¶Šå¤§è¾“å‡ºè¶Šæ¥è¿‘0ã€‚</p>
  </li>
  <li>
    <p>ç¥ç»å…ƒä¸å°±æ˜¯ä¸ªå‡½æ•°å—ï¼Ÿ</p>

    <p>æ˜¯çš„ï¼Œç¥ç»å…ƒå°±æ˜¯ä¸ªå‡½æ•°ã€‚å°†ä¸Šé¢çš„å‡ æ­¥æ•´ç†èµ·æ¥ï¼Œå¦‚æœä½ é€‰å–Sigmoidä½œæ¿€æ´»å‡½æ•°çš„è¯ï¼Œä¸€ä¸ª2è¾“å…¥çš„ç¥ç»å…ƒå°±æ˜¯ï¼š</p>

    <script type="math/tex; mode=display">f(x_1,x_2) = \frac{1}{1+e^{x_1 âˆ— w_1 + x_2 âˆ— w_2 + b}}</script>
  </li>
</ol>

<h3 id="12-ç¥ç»å…ƒå®ä¾‹">1.2 ç¥ç»å…ƒå®ä¾‹</h3>
<p>æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¥å¸®åŠ©ä½ ç†è§£ä»€ä¹ˆæ˜¯ç¥ç»å…ƒï¼š</p>

<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä»¥Sigmoidä½œæ¿€æ´»å‡½æ•°çš„2è¾“å…¥çš„ç¥ç»å…ƒï¼Œå®ƒå…·æœ‰è¿™æ ·çš„å‚æ•°ï¼š</p>

<script type="math/tex; mode=display">w=[0,1]</script>

<script type="math/tex; mode=display">b=4</script>

<p>(w=[0,1]æ˜¯w1=0,w2=1ä½¿ç”¨å‘é‡ä¹¦å†™æ—¶çš„æ ·å­)</p>

<p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªç¥ç»å…ƒæ¥åšè®¡ç®—äº†ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬è¾“å…¥x = [2,3],é‚£ä¹ˆè®¡ç®—è¿‡ç¨‹å°±æ˜¯(ä½¿ç”¨å‘é‡ç‚¹ä¹˜è¡¨ç¤º)ï¼š</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
 result &= Sigmoid(x_1 âˆ— w_1 + x_2 âˆ— w_2 + b)\\&=\ Sigmoid([0,1]\cdot[2,3] +4)\\&=\frac{1}{1+e^7}\approx0.999
\end{aligned} %]]></script>

<p>å³ç¥ç»å…ƒåœ¨è¾“å…¥ä¸º[2,3]çš„æ—¶å€™è¾“å‡ºä¸º0.999ã€‚è¿™æ ·è®¡ç®—æ˜¯ä»è¾“å…¥æ­£å‘ä¼ é€’ä»¥è·å¾—è¾“å‡ºï¼Œè¿™åœ¨ç¥ç»ç½‘ç»œä¸­ç§°ä¸ºæ­£å‘ä¼ æ’­è¿‡ç¨‹ã€‚</p>

<h3 id="13-ç¥ç»å…ƒä»£ç å®ç°">1.3 ç¥ç»å…ƒä»£ç å®ç°</h3>
<p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨äº†NumPyæ¥å®Œæˆä¸€äº›æ•°å­¦è®¡ç®—:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="c1"># Sigmoidæ¿€æ´»å‡½æ•°ï¼šf(x) = 1 / (1 + e^(-x))
</span>  <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">Neuron</span><span class="p">:</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">bias</span>

  <span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="c1"># ç»™è¾“å…¥èµ‹æƒï¼Œæ·»åŠ åç½®ï¼Œç„¶åå¸¦å…¥æ¿€æ´»å‡½æ•°
</span>    <span class="n">total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>
    <span class="k">return</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
</code></pre></div></div>
<p>ç„¶åè¿è¡Œä¸€ä¸‹æµ‹è¯•ï¼š</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># w1 = 0, w2 = 1
</span><span class="n">bias</span> <span class="o">=</span> <span class="mi">4</span>                   <span class="c1"># b = 4
</span><span class="n">n</span> <span class="o">=</span> <span class="n">Neuron</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>       <span class="c1"># x1 = 2, x2 = 3
</span><span class="k">print</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>    <span class="c1"># 0.9990889488055994
</span></code></pre></div></div>

<h2 id="2-æ­å»ºç¥ç»ç½‘ç»œ">2. æ­å»ºç¥ç»ç½‘ç»œ</h2>

<h3 id="21-ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œ">2.1 ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œ?</h3>

<p>ç¥ç»ç½‘ç»œåªä¸è¿‡æ˜¯ä¸€ç¾¤è¿æ¥åœ¨ä¸€èµ·çš„ç¥ç»å…ƒã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œçš„ç¤ºæ„å›¾:
<img src="https://github.com/loopyme/loopyme.github.io/blob/master/_posts/pic/2019-05-01/3.png?raw=true" alt="network.png" /></p>

<p>è¿™ä¸ªç½‘ç»œæœ‰ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªè¾“å…¥çš„è¾“å…¥å±‚(Input Layer)ï¼Œä¸€ä¸ªåŒ…æ‹¬ä¸¤ä¸ªç¥ç»å…ƒ(h1,h2)çš„éšè—å±‚(Hidden Layer)ï¼Œä¸€ä¸ªåŒ…å«ä¸€ä¸ªç¥ç»å…ƒ(o1)çš„è¾“å‡ºå±‚(Output Layer)ã€‚è¿çº¿è¡¨ç¤ºo1çš„è¾“å…¥å°±æ˜¯h1,h2çš„è¾“å‡ºã€‚</p>

<p>æ­£æ˜¯è¿™ç§ä¸Šå±‚è¾“å‡ºä½œä¸ºä¸‹å±‚è¾“å…¥çš„ç‰¹æ€§ï¼Œè¿æ¥èµ·äº†ç¥ç»ç½‘ç»œã€‚</p>

<p><strong>éšè—å±‚</strong>(Hidden Layer)ï¼šè¾“å…¥å±‚å’Œè¾“å‡ºå±‚ä¹‹é—´çš„æ‰€æœ‰å±‚(Layer)éƒ½å«éšè—å±‚ï¼Œä¸€ä¸ªç¥ç»ç½‘ç»œä¸­å¯èƒ½æœ‰å¤šä¸ªéšè—å±‚ã€‚</p>

<h3 id="22-ç¥ç»ç½‘ç»œä¸Šçš„æ­£å‘ä¼ æ’­å®ä¾‹">2.2 ç¥ç»ç½‘ç»œä¸Šçš„æ­£å‘ä¼ æ’­å®ä¾‹</h3>
<p><strong>æ­£å‘ä¼ æ’­</strong>(feedforward):ä»è¾“å…¥æ­£å‘ä¼ é€’ä»¥è·å¾—è¾“å‡ºçš„è¿‡ç¨‹(ç®€å•æ¥è¯´å°±æ˜¯ä»å·¦å¾€å³è®¡ç®—)</p>

<p>æˆ‘ä»¬å°±ä½¿ç”¨ä¸Šå›¾æ‰€ç¤ºçš„ç¥ç»ç½‘ç»œï¼Œå¹¶å‡è®¾æ‰€æœ‰ç¥ç»å…ƒçš„æƒé‡éƒ½ä¸º[0,1],åç½®éƒ½ä¸º0ï¼Œæ¿€æ´»éƒ½ä½¿ç”¨Sigmoidå‡½æ•°ã€‚</p>

<p>é‚£ä¹ˆåœ¨ä¸¤ä¸ªè¾“å…¥éƒ½ä¸º[2,3]çš„æ—¶å€™ï¼Œè®¡ç®—è¾“å‡ºçš„è¿‡ç¨‹å°±ä¸ºï¼š</p>

<p><script type="math/tex">% <![CDATA[
\begin{aligned}
h_1= h_2&=Sigmoid(w\cdot x+b)\\
&=Sigmoid([0,1]\cdot [2,3]+0)\\
&=Sigmoid(3)=0.9526
\end{aligned} %]]></script>
<script type="math/tex">% <![CDATA[
\begin{aligned}
o_1&= Sigmoid(w\cdot [h_1,h_2]+b)\\
&=Sigmoid([0,1]\cdot [0.9526,0.9526]+0)\\
&=Sigmoid(0.9526)=0.7216
\end{aligned} %]]></script></p>

<p>å³ç¥ç»ç½‘ç»œåœ¨è¾“å…¥ä¸º[2,3]çš„æ—¶å€™è¾“å‡ºä¸º0.7216ã€‚</p>

<p>ç¥ç»ç½‘ç»œå¯ä»¥å…·æœ‰ä»»æ„æ•°é‡çš„å±‚ï¼Œè¿™äº›å±‚ä¸­å…·æœ‰ä»»æ„æ•°é‡çš„ç¥ç»å…ƒã€‚ä¸”åŸºæœ¬æ€æƒ³ä¿æŒä¸å˜ï¼šé€šè¿‡ç½‘ç»œä¸­çš„ç¥ç»å…ƒæ­£å‘ä¼ é€’ä»¥è·å¾—è¾“å‡ºã€‚åœ¨ä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨ä¸Šå›¾æ‰€ç¤ºçš„ç½‘ç»œæ¥å®Œæˆè¡¨è¿°ã€‚</p>

<h3 id="23-æ­£å‘ä¼ æ’­çš„ä»£ç å®ç°">2.3 æ­£å‘ä¼ æ’­çš„ä»£ç å®ç°</h3>
<p>ä¾æ—§æ˜¯è¿™ä¸ªç¥ç»ç½‘ç»œ:
<img src="https://github.com/loopyme/loopyme.github.io/blob/master/_posts/pic/2019-05-01/3.png?raw=true" alt="network.png" /></p>

<p>å®ç°ä»£ç ï¼š</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># ... ç¥ç»å…ƒçš„å®ç°éœ€è¦ç²˜è´´åœ¨è¿™é‡Œ
</span>
<span class="k">class</span> <span class="nc">OurNeuralNetwork</span><span class="p">:</span>
  <span class="s">'''
  ä¸€ä¸ªç¥ç»å…ƒï¼Œå®ƒå…·æœ‰:
    - 2*è¾“å…¥
    - 1*éšè—å±‚ = 2*ç¥ç»å…ƒ = (h1, h2)
    - 1*è¾“å‡ºå±‚ = 1*ç¥ç»å…ƒ = (o1)

  æ¯ä¸ªç¥ç»å…ƒéƒ½å…·æœ‰ç›¸åŒçš„æƒé‡å’Œåç½®ï¼š
    - æƒé‡w = [0, 1]
    - åç½®b = 0
  '''</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">bias</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># ç¥ç»å…ƒçš„å®ç°åœ¨1.2ä¸­æåˆ°
</span>    <span class="bp">self</span><span class="o">.</span><span class="n">h1</span> <span class="o">=</span> <span class="n">Neuron</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">h2</span> <span class="o">=</span> <span class="n">Neuron</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">o1</span> <span class="o">=</span> <span class="n">Neuron</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">out_h1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">out_h2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h2</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># o1 çš„è¾“å…¥å°±æ˜¯ h1 å’Œ h2çš„è¾“å‡º
</span>    <span class="n">out_o1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">o1</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">out_h1</span><span class="p">,</span> <span class="n">out_h2</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">out_o1</span>
</code></pre></div></div>

<p>æµ‹è¯•ä»£ç ï¼š</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">network</span> <span class="o">=</span> <span class="n">OurNeuralNetwork</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c1"># 0.7216325609518421
</span></code></pre></div></div>
<p>æœ€ç»ˆæˆ‘ä»¬èƒ½è·å¾—0.7216ä½œä¸ºæ­£å‘ä¼ æ’­è¾“å‡ºã€‚</p>

<h2 id="3è®­ç»ƒç¥ç»ç½‘ç»œ">3.è®­ç»ƒç¥ç»ç½‘ç»œ</h2>
<h3 id="31-è®­ç»ƒä»»åŠ¡">3.1 è®­ç»ƒä»»åŠ¡</h3>
<p>å‡è®¾æˆ‘ä»¬å·²ç»å…·æœ‰è¿™æ ·çš„æ•°æ®ï¼š</p>

<table>
  <thead>
    <tr>
      <th>åå­—</th>
      <th>ä½“é‡(ç£…)</th>
      <th>èº«é«˜(è‹±å°º)</th>
      <th>æ€§åˆ«</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>å¼ ä¸€</td>
      <td>133</td>
      <td>65</td>
      <td>å¥³</td>
    </tr>
    <tr>
      <td>ç‹äºŒ</td>
      <td>160</td>
      <td>72</td>
      <td>ç”·</td>
    </tr>
    <tr>
      <td>åˆ˜ä¸‰</td>
      <td>152</td>
      <td>70</td>
      <td>ç”·</td>
    </tr>
    <tr>
      <td>æå››</td>
      <td>120</td>
      <td>60</td>
      <td>å¥³</td>
    </tr>
  </tbody>
</table>

<p>æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œä½¿å®ƒèƒ½é€šè¿‡ä¸€ä¸ªäººçš„èº«é«˜ä½“é‡æ¥é¢„æµ‹äººçš„æ€§åˆ«ã€‚</p>

<h3 id="32-æŸå¤±å‡½æ•°">3.2 æŸå¤±å‡½æ•°</h3>

<h4 id="321-ä»€ä¹ˆæ˜¯æŸå¤±å‡½æ•°">3.2.1 ä»€ä¹ˆæ˜¯æŸå¤±å‡½æ•°</h4>

<p>åœ¨æˆ‘ä»¬åŸ¹è®­æˆ‘ä»¬çš„ç½‘ç»œä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€‰å–ä¸€ç§æ–¹æ³•æ¥é‡åŒ–ç¥ç»ç½‘ç»œé¢„æµ‹å¾—æœ‰å¤šâ€œå¥½â€ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥å°è¯•åšå¾—â€œæ›´å¥½â€ã€‚æˆ‘ä»¬éœ€è¦çš„å°±æ˜¯æŸå¤±å‡½æ•°ã€‚</p>

<p>æœ¬æ–‡å°†ä½¿ç”¨çš„æ˜¯å‡æ–¹è¯¯å·®(MSE)æŸå¤±:</p>

<script type="math/tex; mode=display">MSE= \frac{1}{n}\sum_{i=1}^n (y_{true}-y_{pred})^2</script>

<ul>
  <li>n æ˜¯æ ·æœ¬æ•°é‡ï¼Œåœ¨å®ä¾‹ä¸­æ˜¯4(å¼ ä¸€, ç‹äºŒ, åˆ˜ä¸‰, æå››)</li>
  <li>y æ˜¯ç›®æ ‡é‡ï¼Œåœ¨å®ä¾‹ä¸­æ˜¯æ€§åˆ«</li>
  <li>$y_{true}$ æ˜¯çœŸå®çš„ç»“æœ(æ­£ç¡®ç­”æ¡ˆ)ï¼Œåœ¨å®ä¾‹ä¸­å¯¹å¼ ä¸€æ¥è¯´å°±æ˜¯1</li>
  <li>$y_{pred}$ æ˜¯é¢„æµ‹çš„ç»“æœï¼Œå°±æ˜¯ç¥ç»ç½‘ç»œè¾“å‡ºçš„ç»“æœã€‚</li>
</ul>

<p>$(y_{true}-y_{pred})^2$ è¢«ç§°ä½œæ–¹å·®(å¹³æ–¹è¯¯å·®)ï¼Œæˆ‘ä»¬è¿™é‡Œçš„æŸå¤±å‡½æ•°åªæ˜¯å–æ‰€æœ‰æ–¹å·®çš„å¹³å‡å€¼(æ•…åâ€œå‡æ–¹å·®â€â€œmean squared errorâ€)ã€‚é¢„æµ‹æ•ˆæœè¶Šå¥½ï¼ŒæŸå¤±å‡½æ•°çš„å€¼å°±ä¼šè¶Šä½ã€‚</p>

<p>ä¹Ÿå°±æ˜¯ï¼š</p>
<ul>
  <li>æ•ˆæœå¥½ = æŸå¤±å°</li>
  <li>è®­ç»ƒç¥ç»ç½‘ç»œ = é™ä½æŸå¤±</li>
</ul>

<h4 id="322-æŸå¤±å‡½æ•°è®¡ç®—å®ä¾‹">3.2.2 æŸå¤±å‡½æ•°è®¡ç®—å®ä¾‹</h4>

<p>æˆ‘ä»¬å‡è®¾æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œè¾“å‡ºå…¨ä¸º0ï¼Œåˆ™æŸå¤±ä¼šæœ‰å¤šå¤§ï¼Ÿ</p>

<table>
  <thead>
    <tr>
      <th>å§“å</th>
      <th>çœŸå®å€¼</th>
      <th>é¢„æµ‹å€¼</th>
      <th>æ–¹å·®</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>å¼ ä¸€</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>ç‹äºŒ</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>åˆ˜ä¸‰</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>æå››</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<script type="math/tex; mode=display">MSE=\frac{1}{4}(1+0+0+1)=0.5</script>

<h4 id="323-æŸå¤±å‡½æ•°è®¡ç®—å®ç°">3.2.3 æŸå¤±å‡½æ•°è®¡ç®—å®ç°</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">mse_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
  <span class="c1"># y_true å’Œ y_pred æ˜¯åŒæ ·é•¿çš„numpy.array
</span>  <span class="k">return</span> <span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<p>æµ‹è¯•ä»£ç ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span> <span class="c1"># 0.5
</span></code></pre></div></div>

<h3 id="33-æ•°æ®é¢„å¤„ç†">3.3 æ•°æ®é¢„å¤„ç†</h3>
<p>æˆ‘ä»¬ç”¨0è¡¨ç¤ºç”·æ€§ï¼Œç”¨1è¡¨ç¤ºå¥³æ€§ï¼Œå¹¶è°ƒæ•´æ•°æ®ï¼Œä½¿å…¶æ›´å®¹æ˜“ä½¿ç”¨:</p>

<table>
  <thead>
    <tr>
      <th>åå­—</th>
      <th>ä½“é‡(135)</th>
      <th>èº«é«˜(66)</th>
      <th>æ€§åˆ«</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>å¼ ä¸€</td>
      <td>-2</td>
      <td>-1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>ç‹äºŒ</td>
      <td>25</td>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <td>åˆ˜ä¸‰</td>
      <td>17</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <td>æå››</td>
      <td>-15</td>
      <td>-6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p>135å’Œ66æ˜¯éšæ„é€‰å–çš„åç§»é‡ï¼Œä»¥ä½¿æ•°æ®æ›´ä¼˜ç¾ï¼Œåç§»ä»¥åŠæ­¤å¤„æœªç”¨åˆ°çš„å½’ä¸€åŒ–éƒ½æ˜¯å¸¸ç”¨çš„è°ƒæ•´æ‰‹æ®µ.</p>

<h3 id="34-åå‘ä¼ æ’­">3.4 åå‘ä¼ æ’­</h3>
<h4 id="341-ä»€ä¹ˆæ˜¯åå‘ä¼ æ’­">3.4.1 ä»€ä¹ˆæ˜¯åå‘ä¼ æ’­ï¼Ÿ</h4>
<p>æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªæ˜ç¡®çš„ç›®æ ‡:æœ€å°åŒ–ç¥ç»ç½‘ç»œçš„æŸå¤±ã€‚å¹¶ä¸”æˆ‘ä»¬è¿˜çŸ¥é“å¯ä»¥é€šè¿‡æ”¹å˜ç¥ç»ç½‘ç»œçš„æƒé‡å’Œåç½®æ¥å½±å“å®ƒçš„é¢„æµ‹ç»“æœï¼Œä½†æˆ‘ä»¬å¦‚ä½•æ‰èƒ½å®ç°ç›®æ ‡å‘¢?</p>

<p>ä¸ºäº†ç®€å•è¯´æ˜æ–¹æ³•ï¼Œå…ˆå‡è®¾æˆ‘ä»¬çš„æ•°æ®é›†ä¸­åªæœ‰å¼ ä¸€:</p>

<table>
  <thead>
    <tr>
      <th>åå­—</th>
      <th>ä½“é‡(135)</th>
      <th>èº«é«˜(66)</th>
      <th>æ€§åˆ«</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>å¼ ä¸€</td>
      <td>-2</td>
      <td>-1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p>è®¡ç®—åˆå§‹å‡æ–¹å·®ï¼š</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
MSE&= \frac{1}{1}\sum_{i=1}^n (y_{true}-y_{pred})^2\\&=(y_{true}-y_{pred})^2\\&=(1-y_{pred})^2
\end{aligned} %]]></script>

<p>å¦ä¸€ç§è€ƒè™‘æŸå¤±çš„æ–¹æ³•æ˜¯å°†æŸå¤±çœ‹ä½œæƒé‡å’Œåç½®çš„å‡½æ•°ã€‚æˆ‘ä»¬å…ˆåœ¨ç¥ç»ç½‘ç»œä¸­æ ‡è®°æ¯ä¸ªæƒé‡å’Œåç½®:
<img src="https://github.com/loopyme/loopyme.github.io/blob/master/_posts/pic/2019-05-01/4.png?raw=true" alt="networkLabled.png" /></p>

<p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†æŸå¤±å†™æˆä¸€ä¸ªå¤šå…ƒå‡½æ•°:</p>

<script type="math/tex; mode=display">Loss(w_1,w_2,w_3,w_4,w_5,w_6,b_1,b_2,b_3)</script>

<p>å‡è®¾æˆ‘ä»¬æƒ³è¦è°ƒæ•´$w_1$,é‚£ä¹ˆLosså°†ä¼šå¦‚ä½•éšä¹‹æ”¹å˜ï¼Ÿè¿™æ—¶å€™ä½ å°±åº”è¯¥æƒ³åˆ°äº†åå¯¼æ•°$\frac{\partial Loss}{\partial w_1}$ã€‚è¿™ä¸å°±æ˜¯åå¯¼æ•°çš„å®šä¹‰å—ï¼Ÿ</p>

<p>è¿™æ—¶å€™å°±éœ€è¦ä¸€äº›æ•°å­¦æ¨å¯¼äº†ã€‚</p>

<p>é¦–å…ˆ,ä½¿ç”¨é“¾å¼æ³•åˆ™å¯¹åå¯¼æ•°å˜å½¢ã€‚</p>

<script type="math/tex; mode=display">\frac{\partial Loss}{\partial w_1}=\frac{\partial Loss}{\partial y_{pred}}*\frac{\partial y_{pred}}{\partial w_1}</script>

<p>ç”±äºæˆ‘ä»¬å¯ä»¥è®¡ç®—Lossçš„å€¼ï¼Œæ‰€ä»¥$\frac{\partial Loss}{\partial y_{pred}}$æ˜¯æˆ‘ä»¬å¯ä»¥æ±‚å¾—çš„</p>

<script type="math/tex; mode=display">\frac{\partial Loss}{\partial y_{pred}}=\frac{\partial (1-y_{pred})^2}{\partial y_{pred}}=-2(1-y_{pred})</script>

<p>ç„¶åæˆ‘ä»¬æ¥æƒ³åŠæ³•è§£å†³${\partial y_{pred}}{\partial w_1}$ï¼Œä½¿ç”¨$h_1,h_2,o_1$æ¥åˆ†åˆ«è¡¨ç¤ºå„ç¥ç»å…ƒçš„è¾“å‡ºï¼Œé‚£ä¹ˆï¼š</p>

<script type="math/tex; mode=display">y_{pred} =o_1 = Sigmoid(w_5*h_1+w_6*h_2+b_3)</script>

<p>ç”±äº$w_1$åªå½±å“$h_1$ï¼Œè€Œä¸$h_2$æ— å…³ï¼Œé‚£ä¹ˆï¼š</p>

<script type="math/tex; mode=display">\frac{\partial y_{pred}}{\partial w_1}=\frac{\partial y_{pred}}{\partial h_1}*\frac{\partial h_1}{\partial w_1}</script>

<script type="math/tex; mode=display">\frac{\partial y_{pred}}{\partial h_1}=w_5*Sigmoid \prime (w_5h_1+w_6h_2+b_3)</script>

<p>å¯¹$\frac{\partial h_1}{\partial w_1}$ï¼Œæˆ‘ä»¬åšç›¸åŒçš„å¤„ç†ï¼š</p>

<script type="math/tex; mode=display">h_1 = Sigmoid(w_1x_1+w_2x_2+b_1)</script>

<script type="math/tex; mode=display">\frac{\partial h_1}{\partial w_1}=x_1*Sigmoid \prime (w_1x_1+w_2x_2+b_1)</script>

<p>ç”±äºè¢«å¤šæ¬¡ç”¨åˆ°ï¼ŒæŠŠSigmoidå‡½æ•°å¯¼å‡½æ•°æ±‚å‡ºæ¥ï¼ˆè¿™é‡Œæš‚æ—¶ä¸ç”¨è¿™ä¸ªæ±‚å¯¼ç»“æœæ¥åŒ–ç®€ä¸Šé¢çš„å¼å­ï¼‰ï¼š</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned} Sigmoid \prime(x) &= (\frac{1}{1+e^{-x}})\prime\\
&=\frac{e^{-x}}{(1+e^{-x})^2}\\
&=Sigmoid(x)*(1-Sigmoid(x))
\end{aligned} %]]></script>

<p>äºæ˜¯ï¼Œæˆ‘ä»¬å°±æŠŠ$\frac{\partial Loss}{\partial w_1}$ç»™æˆåŠŸæ‹†æˆäº†æˆ‘ä»¬èƒ½è®¡ç®—çš„å‡ éƒ¨åˆ†ï¼š</p>

<script type="math/tex; mode=display">\frac{\partial Loss}{\partial w_1}=\frac{\partial Loss}{\partial y_{pred}}*\frac{\partial y_{pred}}{\partial h_1}*\frac{\partial h_1}{\partial w_1}</script>

<p>è¿™æ ·é€†å‘è®¡ç®—åå¯¼æ•°çš„è¿‡ç¨‹ç§°ä¸º<strong>åå‘ä¼ æ’­</strong>(â€œbackpropagationâ€)ã€‚</p>

<h4 id="342-åå‘ä¼ æ’­å®ä¾‹">3.4.2 åå‘ä¼ æ’­å®ä¾‹</h4>

<p>ä¸ºäº†ç®€åŒ–è®¡ç®—ï¼Œæˆ‘ä»¬ç»§ç»­å‡è®¾æˆ‘ä»¬çš„æ•°æ®é›†ä¸­åªæœ‰å¼ ä¸€:</p>

<table>
  <thead>
    <tr>
      <th>åå­—</th>
      <th>ä½“é‡(135)</th>
      <th>èº«é«˜(66)</th>
      <th>æ€§åˆ«</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>å¼ ä¸€</td>
      <td>-2</td>
      <td>-1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p>æŠŠæ‰€æœ‰æƒé‡åˆå§‹åŒ–ä¸º1ï¼Œåç½®åˆå§‹åŒ–ä¸º0ã€‚ç„¶åè¿›è¡Œä¸€æ¬¡<strong>æ­£å‘ä¼ æ’­</strong>ã€‚</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
h_1= h_2&=Sigmoid([w1,w2]\cdot[x1,x2]+b1)\\
&=Sigmoid(-2-1+0)\\
&=Sigmoid(-3)=0.0474
\end{aligned} %]]></script>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
o_1&= Sigmoid([w_5,w_6]\cdot [h_1,h_2]+b3)\\
&=Sigmoid(0.0474+0.0474+0)\\
&=Sigmoid(0.0948)=0.524
\end{aligned} %]]></script>

<p>ç¥ç»ç½‘ç»œçš„ç»“æœä¸º0.524ï¼Œæ„æ€æ˜¯å¹¶ä¸èƒ½æ˜æ˜¾åˆ¤æ–­å‡ºæ˜¯ç”·(1)è¿˜æ˜¯å¥³(0)ã€‚</p>

<p>è¿™æ ·ä»¥åæˆ‘ä»¬è¿›è¡Œä¸€æ¬¡<strong>åå‘ä¼ æ’­</strong>ã€‚ä¹Ÿå°±æ˜¯è®¡ç®—$\frac{\partial Loss}{\partial w_1}$.</p>

<p>ï¼ˆä¸‹é¢è¿™äº›è®¡ç®—çš„æ¨å¯¼éƒ½åœ¨3.4.1ä¸­ï¼‰</p>

<script type="math/tex; mode=display">\frac{\partial Loss}{\partial w_1}=\frac{\partial Loss}{\partial y_{pred}}*\frac{\partial y_{pred}}{\partial h_1}*\frac{\partial h_1}{\partial w_1}</script>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
\frac{\partial Loss}{\partial y_{pred}}&= -2(1-y_{pred})\\
&=-2(1-0.524)=-0.952
\end{aligned} %]]></script>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
\frac{\partial y_{pred}}{\partial h_1}
&=w_5*Sigmoid \prime (w_5h_1+w_6h_2+b_3)\\
&=1*Sigmoid \prime (0.0474+0.0474+0)\\
&= Sigmoid(0.0948)*(1-Sigmoid(0.0948))\\
&= 0.249
\end{aligned} %]]></script>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
\frac{\partial h_1}{\partial w_1}
&=x_1*Sigmoid \prime (w_1x_1+w_2x_2+b_1)\\
&=-2*Sigmoid \prime (-2-1+0)\\
&=-2*Sigmoid(-3)*(1-Sigmoid(-3))\\
&=-0.0904
\end{aligned} %]]></script>

<script type="math/tex; mode=display">\frac{\partial Loss}{\partial w_1}=-0.952*0.249*(-0.0904)=0.0214</script>

<p>å®Œæˆäº†è¿™æ¬¡åå‘ä¼ æ’­ï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†æ”¹å˜w1æ—¶å¯¹Lossçš„å½±å“å¤§å°ï¼š0.0214ã€‚</p>

<h3 id="35-éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•">3.5 éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•</h3>

<p>ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ç§ç§°ä¸ºéšæœºæ¢¯åº¦ä¸‹é™(SGD)çš„ä¼˜åŒ–ç®—æ³•ï¼Œå®ƒä¼šå‘Šè¯‰æˆ‘ä»¬å¦‚ä½•æ”¹å˜æƒé‡å’Œåç½®ä»¥æœ€å°åŒ–æŸå¤±ã€‚å¤§æ¦‚å°±æ˜¯è¿™ä¸ªæ›´æ–°æ–¹ç¨‹:</p>

<script type="math/tex; mode=display">w_1 â† w_1 - Î·\frac{\partial Loss}{\partial w_1}</script>

<p>Î· : å­¦ä¹ é€Ÿç‡(Learning rate)ï¼Œç”¨æ¥æ§åˆ¶è®­ç»ƒæ—¶æ¢¯åº¦ä¸‹é™çš„é€Ÿåº¦ã€‚(å¹¶ä¸æ˜¯è¶Šå¤§è¶Šå¥½ï¼)</p>

<p>æˆ‘ä»¬åšçš„å°±åªæ˜¯æŠŠw1å‡å»$Î·\frac{\partial Loss}{\partial w_1}$ã€‚</p>
<ul>
  <li>è‹¥$Î·\frac{\partial Loss}{\partial w_1}$å¤§äº0ï¼Œw1ä¼šå¢åŠ ï¼Œä»¥é™ä½Lossï¼ˆÎ·åˆé€‚æ—¶ï¼‰</li>
  <li>è‹¥$Î·\frac{\partial Loss}{\partial w_1}$å°äº0ï¼Œw2ä¼šå‡å°‘ï¼Œä»¥é™ä½Lossï¼ˆÎ·åˆé€‚æ—¶ï¼‰</li>
</ul>

<p>å¦‚æœæˆ‘ä»¬å¯¹ç¥ç»ç½‘ç»œä¸­çš„æ¯ä¸€ä¸ªæƒé‡å’Œåç½®éƒ½è¿™æ ·åšï¼ŒæŸå¤±å°±ä¼šæ…¢æ…¢å‡å°‘ï¼Œæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œçš„é¢„æµ‹æ•ˆæœå°±ä¼šæ”¹å–„ã€‚
æˆ‘ä»¬çš„è®­ç»ƒæµç¨‹å¦‚ä¸‹:</p>
<ol>
  <li>ä»æ•°æ®é›†ä¸­é€‰æ‹©ä¸€ä¸ªç¤ºä¾‹ï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•è¦æ±‚æˆ‘ä»¬æ¯æ¬¡åªå¯¹ä¸€ä¸ªæ ·æœ¬è¿›è¡Œæ“ä½œï¼‰</li>
  <li>è®¡ç®—æ‰€æœ‰â€œæŸå¤±å¯¹æƒé‡æˆ–åç½®çš„åå¯¼æ•°â€ï¼ˆå¼•å·ç”¨äºè¾…åŠ©æ–­å¥ï¼‰</li>
  <li>æ›´æ–°æƒé‡æˆ–åç½®ï¼ˆæ³¨æ„ï¼šè¿™é‡Œä¸æ˜¯ç®—ä¸€ä¸ªåå¯¼æ›´æ–°ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯å…¨éƒ¨ä¸€èµ·æ›´æ–°ï¼‰</li>
  <li>å›åˆ°æ­¥éª¤1ï¼Œç›´è‡³Lossåˆ°è¾¾æ»¡æ„çš„åŒºé—´</li>
</ol>

<h3 id="36-è®­ç»ƒç¥ç»ç½‘ç»œä»£ç å®ç°">3.6 è®­ç»ƒç¥ç»ç½‘ç»œä»£ç å®ç°</h3>

<table>
  <thead>
    <tr>
      <th>åå­—</th>
      <th>ä½“é‡(135)</th>
      <th>èº«é«˜(66)</th>
      <th>æ€§åˆ«</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>å¼ ä¸€</td>
      <td>-2</td>
      <td>-1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>ç‹äºŒ</td>
      <td>25</td>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <td>åˆ˜ä¸‰</td>
      <td>17</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <td>æå››</td>
      <td>-15</td>
      <td>-6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p><img src="https://github.com/loopyme/loopyme.github.io/blob/master/_posts/pic/2019-05-01/4.png?raw=true" alt="networkLabled.png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="c1"># sigmoidå‡½æ•°ï¼šf(x) = 1 / (1 + e^(-x))
</span>  <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">deriv_sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="c1"># sigmoidå‡½æ•°çš„å¯¼æ•°ï¼šf'(x) = f(x) * (1 - f(x))
</span>  <span class="n">fx</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">fx</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">fx</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">mse_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
  <span class="c1"># y_true å’Œ y_pred æ˜¯åŒæ ·é•¿çš„numpy.array
</span>  <span class="k">return</span> <span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">OurNeuralNetwork</span><span class="p">:</span>
   <span class="s">'''
  ä¸€ä¸ªç¥ç»å…ƒï¼Œå®ƒå…·æœ‰:
    - 2*è¾“å…¥
    - 1*éšè—å±‚ = 2*ç¥ç»å…ƒ = (h1, h2)
    - 1*è¾“å‡ºå±‚ = 1*ç¥ç»å…ƒ = (o1)

  æ¯ä¸ªç¥ç»å…ƒéƒ½å…·æœ‰ç›¸åŒçš„æƒé‡å’Œåç½®ï¼š
    - æƒé‡w = [0, 1]
    - åç½®b = 0
  '''</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># æƒé‡
</span>    <span class="bp">self</span><span class="o">.</span><span class="n">w1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>

    <span class="c1"># åç½®
</span>    <span class="bp">self</span><span class="o">.</span><span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">b2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">b3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># x æ˜¯len=2çš„numpy.array
</span>    <span class="n">h1</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b1</span><span class="p">)</span>
    <span class="n">h2</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w3</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w4</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b2</span><span class="p">)</span>
    <span class="n">o1</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w5</span> <span class="o">*</span> <span class="n">h1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w6</span> <span class="o">*</span> <span class="n">h2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">o1</span>

  <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">all_y_trues</span><span class="p">):</span>
    <span class="s">'''
    - data æ˜¯(n x 2)çš„numpy.array,næ˜¯æ ·æœ¬å®¹é‡.
    - all_y_trues æ˜¯ï¼ˆn*1ï¼‰çš„numpy.arrayï¼Œä¸dataç›¸å¯¹åº”
    '''</span>
    <span class="n">learn_rate</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># å­¦ä¹ ç‡
</span>    <span class="c1">#epochï¼šæ‰€æœ‰è®­ç»ƒæ•°æ®ä¸€æ¬¡æ­£å‘ä¼ æ’­ï¼Œå‘åä¼ æ’­ï¼Œæ›´æ–°å‚æ•°çš„è¿‡ç¨‹
</span>    <span class="n">epochs</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># epochæ¬¡æ•°
</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_true</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">all_y_trues</span><span class="p">):</span>
        <span class="c1"># æ­£å‘ä¼ æ’­
</span>        <span class="n">sum_h1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b1</span>
        <span class="n">h1</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">sum_h1</span><span class="p">)</span>

        <span class="n">sum_h2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w3</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w4</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b2</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">sum_h2</span><span class="p">)</span>

        <span class="n">sum_o1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w5</span> <span class="o">*</span> <span class="n">h1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w6</span> <span class="o">*</span> <span class="n">h2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b3</span>
        <span class="n">o1</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">o1</span>

        <span class="c1"># å‘åä¼ æ’­
</span>        <span class="c1"># d_L_d_w1 è¡¨ç¤º " Lå¯¹w1çš„åå¯¼æ•°"
</span>        <span class="n">d_L_d_ypred</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span>

        <span class="c1"># ç¥ç»å…ƒ o1
</span>        <span class="n">d_ypred_d_w5</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>
        <span class="n">d_ypred_d_w6</span> <span class="o">=</span> <span class="n">h2</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>
        <span class="n">d_ypred_d_b3</span> <span class="o">=</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>

        <span class="n">d_ypred_d_h1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w5</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>
        <span class="n">d_ypred_d_h2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w6</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_o1</span><span class="p">)</span>

        <span class="c1"># ç¥ç»å…ƒ h1
</span>        <span class="n">d_h1_d_w1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h1</span><span class="p">)</span>
        <span class="n">d_h1_d_w2</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h1</span><span class="p">)</span>
        <span class="n">d_h1_d_b1</span> <span class="o">=</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h1</span><span class="p">)</span>

        <span class="c1"># ç¥ç»å…ƒ h2
</span>        <span class="n">d_h2_d_w3</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h2</span><span class="p">)</span>
        <span class="n">d_h2_d_w4</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h2</span><span class="p">)</span>
        <span class="n">d_h2_d_b2</span> <span class="o">=</span> <span class="n">deriv_sigmoid</span><span class="p">(</span><span class="n">sum_h2</span><span class="p">)</span>

        <span class="c1"># æ›´æ–°æƒé‡å’Œåç½®
</span>        <span class="c1"># ç¥ç»å…ƒ h1
</span>        <span class="bp">self</span><span class="o">.</span><span class="n">w1</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h1</span> <span class="o">*</span> <span class="n">d_h1_d_w1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w2</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h1</span> <span class="o">*</span> <span class="n">d_h1_d_w2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b1</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h1</span> <span class="o">*</span> <span class="n">d_h1_d_b1</span>

        <span class="c1"># ç¥ç»å…ƒ h2
</span>        <span class="bp">self</span><span class="o">.</span><span class="n">w3</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h2</span> <span class="o">*</span> <span class="n">d_h2_d_w3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w4</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h2</span> <span class="o">*</span> <span class="n">d_h2_d_w4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b2</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_h2</span> <span class="o">*</span> <span class="n">d_h2_d_b2</span>

        <span class="c1"># ç¥ç»å…ƒ o1
</span>        <span class="bp">self</span><span class="o">.</span><span class="n">w5</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_w5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w6</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_w6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b3</span> <span class="o">-=</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">d_L_d_ypred</span> <span class="o">*</span> <span class="n">d_ypred_d_b3</span>

      <span class="c1"># --- æ¯10epochè®¡ç®—è¾“å‡ºä¸€æ¬¡Loss
</span>      <span class="k">if</span> <span class="n">epoch</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">y_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feedforward</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">mse_loss</span><span class="p">(</span><span class="n">all_y_trues</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Epoch </span><span class="si">%</span><span class="s">d loss: </span><span class="si">%.3</span><span class="s">f"</span> <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">loss</span><span class="p">))</span>
</code></pre></div></div>

<p>æµ‹è¯•ä»£ç ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># æ•°æ®é›†å®šä¹‰
</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
  <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># å¼ ä¸€
</span>  <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>   <span class="c1"># ç‹äºŒ
</span>  <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>   <span class="c1"># åˆ˜ä¸‰
</span>  <span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="c1"># æå››
</span><span class="p">])</span>
<span class="n">all_y_trues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
  <span class="mi">1</span><span class="p">,</span> <span class="c1"># å¼ ä¸€
</span>  <span class="mi">0</span><span class="p">,</span> <span class="c1"># ç‹äºŒ
</span>  <span class="mi">0</span><span class="p">,</span> <span class="c1"># åˆ˜ä¸‰
</span>  <span class="mi">1</span><span class="p">,</span> <span class="c1"># æå››
</span><span class="p">])</span>

<span class="c1"># è®­ç»ƒ!
</span><span class="n">network</span> <span class="o">=</span> <span class="n">OurNeuralNetwork</span><span class="p">()</span>
<span class="n">network</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">all_y_trues</span><span class="p">)</span>
</code></pre></div></div>

<p>äºæ˜¯æˆ‘ä»¬å°±è·å¾—ä¸€ä¸ªè®­ç»ƒå¥½çš„ç¥ç»ç½‘ç»œï¼Œæ¥ä¸‹æ¥ç”¨å®ƒæ¥é¢„æµ‹ä¸€ä¸‹ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ç”¨ä¸€äº›ç¥ç»ç½‘ç»œæ²¡è§è¿‡çš„æ•°æ®æ¥åšé¢„æµ‹
</span><span class="n">emily</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># 128 pounds, 63 inches
</span><span class="n">frank</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># 155 pounds, 68 inches
</span><span class="k">print</span><span class="p">(</span><span class="s">"Emily: </span><span class="si">%.3</span><span class="s">f"</span> <span class="o">%</span> <span class="n">network</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">emily</span><span class="p">))</span> <span class="c1"># 0.951 - F
</span><span class="k">print</span><span class="p">(</span><span class="s">"Frank: </span><span class="si">%.3</span><span class="s">f"</span> <span class="o">%</span> <span class="n">network</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">frank</span><span class="p">))</span> <span class="c1"># 0.039 - M
</span></code></pre></div></div>

<p>å®Œç¾ï¼å¿«é€Ÿå›é¡¾ä¸€ä¸‹æˆ‘ä»¬åœ¨è¿™ç¯‡æ–‡ç« ä¸­åšçš„:</p>
<ul>
  <li>ä»‹ç»äº†<strong>ç¥ç»å…ƒ</strong>ï¼Œç¥ç»ç½‘ç»œçš„ç»„æˆéƒ¨åˆ†ã€‚</li>
  <li>åœ¨æˆ‘ä»¬çš„ç¥ç»å…ƒä¸­ä½¿ç”¨<strong>Sigmoidæ¿€æ´»å‡½æ•°</strong>ã€‚</li>
  <li>æ„è¯†åˆ°<strong>ç¥ç»ç½‘ç»œ</strong>åªæ˜¯ä¸€äº›è¿æ¥åœ¨ä¸€èµ·çš„ç¥ç»å…ƒã€‚</li>
  <li>åˆ›å»ºäº†ä¸€ä¸ª<strong>æ•°æ®é›†</strong>ï¼Œå…¶ä¸­å°†ä½“é‡å’Œèº«é«˜ä½œä¸ºè¾“å…¥(æˆ–ç‰¹æ€§)ï¼Œæ€§åˆ«ä½œä¸ºè¾“å‡º(æˆ–æ ‡ç­¾)ã€‚</li>
  <li>å­¦ä¹ äº†<strong>æŸå¤±å‡½æ•°</strong>å’Œå‡æ–¹è¯¯å·®æŸå¤±ã€‚</li>
  <li>æ„è¯†åˆ°<strong>è®­ç»ƒ</strong>ä¸€ä¸ªç½‘ç»œåªæ˜¯æŠŠå®ƒçš„æŸå¤±å‡½æ•°å€¼é™åˆ°æœ€ä½ã€‚</li>
  <li>ä½¿ç”¨<strong>åå‘ä¼ æ’­</strong>è®¡ç®—åå¯¼æ•°ã€‚</li>
  <li>åˆ©ç”¨<strong>éšæœºæ¢¯åº¦ä¸‹é™æ³•</strong>(SGD)å¯¹ç½‘ç»œè¿›è¡Œè®­ç»ƒã€‚</li>
</ul>

<p>æ¥ä¸‹æ¥è¿›é˜¶å­¦ä¹ éœ€è¦åšçš„:</p>
<ul>
  <li>ä½¿ç”¨<strong>æœºå™¨å­¦ä¹ åº“</strong>(å¦‚Tensorflowã€Keraså’ŒPyTorch)æ¥è®­ç»ƒæ›´å¤§/æ›´å¥½çš„ç¥ç»ç½‘ç»œã€‚</li>
  <li>å‘ç°Sigmoidä»¥å¤–çš„å…¶ä»–<strong>æ¿€æ´»å‡½æ•°</strong>ã€‚</li>
  <li>å‘ç°é™¤éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼ˆSGDï¼‰ä¹‹å¤–çš„å…¶ä»–<strong>ä¼˜åŒ–å™¨</strong>ã€‚</li>
  <li>å­¦ä¹ å½»åº•æ”¹å˜äº†è®¡ç®—æœºè§†è§‰çš„<strong>å·ç§¯ç¥ç»ç½‘ç»œ</strong>ã€‚</li>
  <li>å­¦ä¹ ç»å¸¸ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†(NLP)çš„<strong>é€’å½’ç¥ç»ç½‘ç»œ</strong>ã€‚</li>
</ul>
:ET